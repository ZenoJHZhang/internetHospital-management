(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-3b44"],{Do8I:function(t,e,r){"use strict";r.d(e,"e",function(){return o}),r.d(e,"b",function(){return a}),r.d(e,"f",function(){return i}),r.d(e,"d",function(){return s}),r.d(e,"c",function(){return c}),r.d(e,"a",function(){return m});var n=r("t3Un");function o(t,e,r,o){return Object(n.a)({url:"/managementDepartment/listDepartmentByNameOrNumberWithDepartmentMessage",method:"post",params:{departmentMessage:t,departmentType:e,pageNumber:r,pageSize:o}})}function a(t){return Object(n.a)({url:"/managementDepartment/getDepartmentById",method:"get",params:{departmentId:t}})}function i(t){return Object(n.a)({url:"/managementDepartment/updateDepartment",method:"post",data:t})}function s(t,e){return Object(n.a)({url:"/img/insertDepartmentImg",method:"post",params:{imgStr:t,departmentId:e}})}function c(t){return Object(n.a)({url:"/managementDepartment/insertDepartment",method:"post",data:t})}function m(t){return Object(n.a)({url:"/managementDepartment/deleteDepartment",method:"post",params:{departmentId:t}})}},EmVA:function(t,e,r){"use strict";r.d(e,"e",function(){return o}),r.d(e,"b",function(){return a}),r.d(e,"f",function(){return i}),r.d(e,"c",function(){return s}),r.d(e,"a",function(){return c}),r.d(e,"d",function(){return m});var n=r("t3Un");function o(t,e,r,o){return Object(n.a)({url:"/managementDoctor/listDoctorByNameOrNumberWithDepartmentId",method:"post",params:{doctorMessage:t,departmentId:e,pageNumber:r,pageSize:o}})}function a(t){return Object(n.a)({url:"/managementDoctor/getDoctorById",method:"get",params:{doctorId:t}})}function i(t){return Object(n.a)({url:"/managementDoctor/updateDoctor",method:"post",data:t})}function s(t){return Object(n.a)({url:"/managementDoctor/insertDoctor",method:"post",data:t})}function c(t){return Object(n.a)({url:"/managementDoctor/deleteDoctor",method:"post",params:{doctorId:t}})}function m(t,e){return Object(n.a)({url:"/img/insertDoctorImg",method:"post",params:{imgStr:t,doctorId:e}})}},QmVU:function(t,e,r){},gPbP:function(t,e,r){"use strict";var n=r("QmVU");r.n(n).a},mVVY:function(t,e,r){"use strict";r.r(e);var n=r("4d7F"),o=r.n(n),a=r("EmVA"),i=r("Do8I"),s=(r("201c"),{components:{"my-upload":r("C03Y").a},data:function(){var t=this;return{doctorForm:{doctorName:"",doctorNumber:"",doctorTitle:"",goodAt:"",phone:"",departmentList:[],imgPath:""},rules:{goodAt:[{required:!0,message:"请输入医生擅长",trigger:"blur"}],doctorTitle:[{required:!0,message:"请选择医生职称",trigger:"blur"}],doctorNumber:[{required:!0,message:"请输入医生编号",trigger:"change"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入医生手机号",trigger:"change"},{pattern:"^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199|(147))\\d{8}$",message:"手机号格式错误",trigger:"blur"}],doctorDepartmentList:[{required:!0,validator:function(e,r,n){0===t.doctorDepartmentList.length?n(new Error("请至少选择一个所属科室")):n()},trigger:"blur"}]},show:!1,imgDataUrl:"",changeImgFlag:!1,doctorTitleList:[{value:"医生-住院医师",label:"医生-住院医师"},{value:"医生-主治医师",label:"医生-主治医师"},{value:"医生-副主任医师",label:"医生-副主任医师"},{value:"医生-主任医师",label:"医生-主任医师"}],doctorDepartmentList:[],inputVisible:!1,inputValue:"",departmentDiaglogVisible:!1,departmentList:[],departmentMessage:"",departmentType:2,newDepartmentList:[],checkedClass:"checked"}},mounted:function(){this.$nextTick(function(){this.getDoctorDetail()})},methods:{submitForm:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.doctorForm.departmentList=e.doctorDepartmentList,Object(a.f)(e.doctorForm).then(function(t){200===t.data.returnCode&&(e.changeImgFlag?Object(a.d)(e.imgDataUrl,t.data.returnData).then(function(t){200===t.data.returnCode&&(e.$store.state.errorTokenVisible=!0,e.$store.state.errorTokenMessage="更新医生成功！",e.$router.push({name:"DoctorManagement"}))}):(e.$store.state.errorTokenVisible=!0,e.$store.state.errorTokenMessage="更新医生成功！",e.$router.push({name:"DoctorManagement"})))})})},getDoctorDetail:function(){var t=this,e=this.$route.query.doctorId;return null==e&&this.$router.push({name:"DoctorManagement"}),new o.a(function(r,n){Object(a.b)(e).then(function(e){t.doctorForm=e.data.returnData,t.doctorDepartmentList=t.doctorForm.departmentList,r(e)}).catch(function(t){n(t)})})},toggleShow:function(){this.show=!this.show},cropSuccess:function(t,e){this.imgDataUrl=t,this.changeImgFlag=!0},goBack:function(){this.$router.push({name:"DeparmentManagement"})},handleClose:function(t){this.doctorDepartmentList.splice(this.doctorDepartmentList.indexOf(t),1)},handleInputConfirm:function(){var t=this.inputValue;t&&this.dynamicTags.push(t),this.inputVisible=!1,this.inputValue=""},listDepartmentByNameOrNumberWithDepartmentMessage:function(){var t=this;return new o.a(function(e,r){Object(i.e)(t.departmentMessage,t.departmentType,0,0).then(function(r){var n=r.data.returnData;t.total=n.total,t.departmentList=n.list,t.newDepartmentList=[],t.doctorDepartmentList.forEach(function(e){t.newDepartmentList.push(e.id)}),e(r)}).catch(function(t){r(t)})})},choiceDepartment:function(){this.listDepartmentByNameOrNumberWithDepartmentMessage(),this.newDepartmentList=[],this.departmentDiaglogVisible=!0},changeDepartmentType:function(t){this.departmentType=t,this.listDepartmentByNameOrNumberWithDepartmentMessage()},addNewDepartment:function(t,e){var r=!1;this.doctorDepartmentList.forEach(function(t){1===t.deptType&&(r=!0)}),t?1===e.deptType&&r?(this.newDepartmentList.splice(this.newDepartmentList.indexOf(e),1),this.$store.state.errorTokenVisible=!0,this.$store.state.errorTokenMessage="医生已有所属专家科室"):this.doctorDepartmentList.push(e):this.doctorDepartmentList.splice(this.doctorDepartmentList.indexOf(e),1)},confirmAddNewDepartmentList:function(){this.departmentDiaglogVisible=!1}}}),c=(r("gPbP"),r("KHd+")),m=Object(c.a)(s,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-container",[r("el-main",[r("el-form",{ref:"doctorForm",staticStyle:{width:"50%"},attrs:{model:t.doctorForm,rules:t.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"医生头像",prop:"doctorImg"}},[r("span",{staticStyle:{"margin-left":"20px"}},[r("my-upload",{attrs:{width:120,height:120,field:"img","img-format":"png","with-credentials":"","no-circle":""},on:{"crop-success":t.cropSuccess},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}})],1),t._v(" "),r("img",{attrs:{src:""!=t.imgDataUrl?t.imgDataUrl:t.doctorForm.imgPath,width:"120px",height:"120px"}}),t._v(" "),r("el-button",{staticStyle:{"margin-left":"50px"},attrs:{type:"primary"},on:{click:t.toggleShow}},[t._v("选择医生示例图")])],1),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"医生姓名",prop:"doctorName"}},[r("span",[t._v(t._s(t.doctorForm.doctorName))])]),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"身份证号",prop:"doctorIdCard"}},[r("span",[t._v(t._s(t.doctorForm.doctorIdCard))])]),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"医生工号",prop:"doctorNumber"}},[r("el-input",{attrs:{max:"400"},model:{value:t.doctorForm.doctorNumber,callback:function(e){t.$set(t.doctorForm,"doctorNumber",e)},expression:"doctorForm.doctorNumber"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"医生职称",prop:"doctorTitle"}},[r("el-select",{attrs:{placeholder:"请选择医生职称"},model:{value:t.doctorForm.doctorTitle,callback:function(e){t.$set(t.doctorForm,"doctorTitle",e)},expression:"doctorForm.doctorTitle"}},t._l(t.doctorTitleList,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"医生擅长",prop:"goodAt"}},[r("el-input",{attrs:{type:"textarea",max:"400",rows:"3"},model:{value:t.doctorForm.goodAt,callback:function(e){t.$set(t.doctorForm,"goodAt",e)},expression:"doctorForm.goodAt"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"50%"},attrs:{label:"医生手机",prop:"phone"}},[r("el-input",{attrs:{max:"400"},model:{value:t.doctorForm.phone,callback:function(e){t.$set(t.doctorForm,"phone",e)},expression:"doctorForm.phone"}})],1),t._v(" "),r("el-form-item",{staticStyle:{width:"100%"},attrs:{label:"所属科室",prop:"doctorDepartmentList"}},[t._l(t.doctorDepartmentList,function(e){return r("el-tag",{key:e.id,attrs:{"disable-transitions":!1,closable:"",color:"white"},on:{close:function(r){t.handleClose(e)}}},[t._v(t._s(e.departmentName))])}),t._v(" "),t.inputVisible?r("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):r("el-button",{staticClass:"button-new-tag",attrs:{type:"primary"},on:{click:t.choiceDepartment}},[t._v("+ 新增医生所属科室")])],2),t._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitForm("doctorForm")}}},[t._v("立即更新")]),t._v(" "),r("el-button",{attrs:{type:"info"},on:{click:function(e){t.goBack()}}},[t._v("取消")])],1)],1)],1)],1),t._v(" "),r("el-dialog",{attrs:{visible:t.departmentDiaglogVisible,title:"提示",width:"50%"},on:{"update:visible":function(e){t.departmentDiaglogVisible=e}}},[r("el-container",[r("el-header",{staticStyle:{"padding-top":"20px"}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:10}},[r("el-input",{attrs:{placeholder:"根据科室名/科室编号模糊搜索","prefix-icon":"el-icon-search"},nativeOn:{keyup:function(e){t.listDepartmentByNameOrNumberWithDepartmentMessage()}},model:{value:t.departmentMessage,callback:function(e){t.departmentMessage=e},expression:"departmentMessage"}})],1),t._v(" "),r("el-col",{attrs:{span:12}},[r("el-button-group",[r("el-button",{attrs:{type:"primary",icon:"el-icon-menu"},on:{click:function(e){t.changeDepartmentType(2)}}},[t._v("全部科室")]),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-star-on"},on:{click:function(e){t.changeDepartmentType(1)}}},[t._v("专家科室")]),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-star-off"},on:{click:function(e){t.changeDepartmentType(0)}}},[t._v("普通科室")])],1)],1)],1)],1),t._v(" "),r("el-main",{staticStyle:{"margin-top":"20px"}},t._l(t.departmentList,function(e,n){return r("el-checkbox",{key:n,staticClass:"department-name-style",attrs:{label:e.id,border:""},on:{change:function(r){return t.addNewDepartment(r,e)}},model:{value:t.newDepartmentList,callback:function(e){t.newDepartmentList=e},expression:"newDepartmentList"}},[t._v(t._s(e.departmentName))])}))],1),t._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.departmentDiaglogVisible=!1}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.confirmAddNewDepartmentList()}}},[t._v("确 定")])],1)],1)],1)},[],!1,null,null,null);m.options.__file="editDoctor.vue";e.default=m.exports}}]);